<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <link rel="stylesheet" type="text/css" href="../css/aui.css" />
</head>
<body>
  <header class="aui-bar aui-bar-nav" id="aui-header">
      <a class="aui-btn aui-pull-left" tapmode onclick="closeWin()">
          <span class="aui-iconfont aui-icon-left"></span>
      </a>
      <div class="aui-title">客服</div>
  </header>
  <footer class="aui-bar aui-bar-tab" id="footer">
      <div class="aui-bar-tab-item aui-padded-l-15 aui-padded-r-15">

  </footer>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript">
    apiready = function(){
        api.parseTapmode();
        var header = $api.byId('aui-header');
        $api.fixStatusBar(header);
        var headerPos = $api.offset(header);
        var body_h = $api.offset($api.dom('body')).h;
        var footerH = $api.offset($api.byId('footer')).h;
        api.openFrame({
            name: 'kefu_frm',
            url: 'kefu_frm.html',
            bounces: true,
            rect: {
                x: 0,
                y: headerPos.h,
                w: 'auto',
                h: api.winHeight-headerPos.h-footerH
            }
        })
        api.addEventListener({
            name: 'keyback'
        }, function(ret, err){
            if( ret ){
              api.historyBack({
                  frameName:'shouye_frm'
              },function(ret,err){
                  if(!ret.status){
                      api.closeWin();
                  }
              });

                 alert( JSON.stringify( ret ) );
            }else{
                 alert( JSON.stringify( err ) );
            }
        });

    };
    <script>
      function closeWin(){
        api.historyBack({
            frameName:'shouye_frm'
        },function(ret,err){
            if(!ret.status){
                api.closeWin();
            }
        });

      }
    </script>
</script>
</html>
